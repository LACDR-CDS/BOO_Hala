"0","go_sets <- AnnotationDbi::select(org.Hs.eg.db, keys=DIPA_bmd$'Probe ID',"
"0","                                 columns=c(""GO""), keytype=""SYMBOL"") %>%"
"0","  filter(ONTOLOGY == ""BP"")  # biological process GO terms"
"2","'select()' returned 1:many mapping between keys and columns
"
"0","go_bmdhigh <- inner_join(go_sets, DIPA_bmd, by = c(""SYMBOL"" = ""Probe ID""))"
"0",""
"0","gene_set_summaryhigh <- go_bmd %>%"
"0","  group_by(GO) %>%"
"0","  summarize(total_genes = n(),"
"0","            genes_with_bmdhigh = sum(!is.na('Best BMD')),"
"0","            percent_with_bmdhigh = genes_with_bmdhigh / total_genes)"
"0",""
"0","filtered_setshigh <- gene_set_summaryhigh %>%"
"0","  filter(total_genes >= 3, percent_with_bmdhigh >= 0.05) %>%"
"0","  pull(GO)"
"0",""
"0","# 4. Calculate median BMD per filtered gene set"
"0","median_bmd_per_sethigh <- go_bmdhigh %>%"
"0","  filter(GO %in% filtered_setshigh) %>%"
"0","  group_by(GO) %>%"
"0","  summarize(median_bmd = median(`Best BMD`, na.rm=TRUE))"
"0",""
"0","# 5. Determine tPOD: lowest median BMD across gene sets"
"0","tPODhigh <- min(median_bmd_per_sethigh$median_bmd)"
"0",""
"0","print(paste(""Transcriptomic POD (tPOD) is:"", tPODhigh))"
"1","[1]"
"1"," ""Transcriptomic POD (tPOD) is: 0.0277068"""
"1","
"
