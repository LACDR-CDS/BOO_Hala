"0",""
"0","plot_data_for_corr_boxplot <- metaData %>%"
"0","  left_join(replicateFilterOutput, by = ""sample_ID"") %>%"
"0","  filter(!is.na(max_r2)) "
"0",""
"0","if (nrow(plot_data_for_corr_boxplot) > 0) {"
"0","  correlation_boxplot <- ggplot(plot_data_for_corr_boxplot, aes(x = mean_ID, y = max_r2)) +"
"0","    geom_boxplot("
"0","      aes(fill = sample_type), "
"0","      outlier.shape = NA,      "
"0","      alpha = 0.7,"
"0","      notch = FALSE,"
"0","      width = 0.9"
"0","    ) +"
"0","    geom_jitter("
"0","      aes(color = sample_type), "
"0","      width = 0.2,"
"0","      alpha = 0.6,"
"0","      size = 1.5"
"0","    ) +"
"0","    geom_hline("
"0","      yintercept = corr_threshold, "
"0","      linetype = ""dashed"", "
"0","      color = ""red"", "
"0","      linewidth = 1"
"0","    ) +"
"0","    annotate("
"0","      ""text"", "
"0","      x = -Inf, "
"0","      y = corr_threshold, "
"0","      label = paste(""Corr. Threshold ="", corr_threshold), "
"0","      hjust = -0.05, "
"0","      vjust = -0.5,  "
"0","      color = ""red"", "
"0","      size = 3"
"0","    ) +"
"0","    scale_fill_brewer(palette = ""Pastel1"", name = ""Sample Type:"") + "
"0","    scale_color_brewer(palette = ""Set1"", name = ""Sample Type:"") +   "
"0","    labs("
"0","      title = ""Distribution of Maximum Pairwise Replicate Correlations (max_r2)"","
"0","      subtitle = ""Each point is a sample, showing its max correlation with other replicates in its group."","
"0","      x = ""Experimental Condition (mean_ID)"","
"0","      y = ""Maximum Pairwise Correlation (max_r2)"""
"0","    ) +"
"0","    theme_minimal(base_size = 11) + "
"0","    theme("
"0","      plot.title = element_text(hjust = 0.5, face = ""bold"", size = 11),"
"0","      plot.subtitle = element_text(hjust = 0.5, size = 9),"
"0","      axis.text.x = element_text(angle = 60, hjust = 1, size = 7), "
"0","      axis.text.y = element_text(size = 8),"
"0","      axis.title = element_text(size = 10, face = ""bold""),"
"0","      legend.title = element_text(size = 9, face = ""bold""),"
"0","      legend.text = element_text(size = 8),"
"0","      legend.position = ""top"""
"0","    )"
"0",""
"0","  print(correlation_boxplot)"
"0","}"
