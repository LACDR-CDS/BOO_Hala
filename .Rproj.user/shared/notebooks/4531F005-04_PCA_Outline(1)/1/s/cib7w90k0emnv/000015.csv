"0","# Calculate the SD of each column in metadata"
"0","plot_vars <- apply(metaData, 2, function(x) sd(as.numeric(factor(x)), na.rm=T))"
"0",""
"0","# Save column names that vary (SD is not NA or 0)"
"0","plot_vars <- names(plot_vars[!plot_vars %in% c(NA, 0)])"
"0",""
"0","# Remove PC column names"
"0","plot_vars <- plot_vars[!grepl(""PC"", plot_vars)]"
"0",""
"0","# Inspect"
"0","plot_vars"
"1"," [1]"
"1"," ""X""              "
"1"," ""sample_ID""      "
"1"," ""sample_type""    "
"1"," ""compound_ID""    "
"1"," ""compound_CAS""   "
"1","
"
"1"," [6]"
"1"," ""compound_name""  "
"1"," ""compound_abbr""  "
"1"," ""mean_ID""        "
"1"," ""mean_ID_control"""
"1"," ""control_type""   "
"1","
"
"1","[11]"
"1"," ""conc_ID""        "
"1"," ""conc_amt""       "
"1"," ""rep""            "
"1"," ""read_depth""     "
"1"," ""plate_ID""       "
"1","
"
"1","[16]"
"1"," ""plate_well""     "
"1"," ""plate_row""      "
"1"," ""plate_col""      "
"1"," ""batch""          "
"1"," ""compound_class"" "
"1","
"
"1","[21]"
"1"," ""LOAEL_amt""      "
"1"," ""PBPK_equivalent"""
"1"," ""lib_size""       "
"1"," ""max_r2""         "
"1","
"
"0","# Subset metadata to include only these columns"
"0","heatmap_df <- metaData %>% "
"0","  select(any_of(plot_vars))"
"0","# Convert all variables to numeric values"
"0","heatmap_df <- apply(heatmap_df, 2, function(x) as.numeric(factor(x)))"
"0",""
"0","# Calculate correlations between the first 10 PCs and these numeric variables scaled"
"0","cxy <- round(cor(pcs$x[,1:10], scale(heatmap_df), "
"0","                 use = ""pairwise.complete.obs""), 2) "
"0",""
"0","# Inspect"
"0","as.data.frame(cxy)"
