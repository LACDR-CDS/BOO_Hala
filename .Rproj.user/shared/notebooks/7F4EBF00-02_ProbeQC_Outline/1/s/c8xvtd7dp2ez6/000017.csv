"0","# Create a vector of unique mean IDs"
"0","loop <- unique(metaData$mean_ID)"
"0","loop"
"1"," [1]"
"1"," ""CS1106_1_P1"""
"1"," ""CS1106_2_P1"""
"1"," ""CS1106_3_P1"""
"1"," ""CS1106_4_P1"""
"1"," ""CS1106_5_P1"""
"1"," ""CS1106_6_P1"""
"1"," ""CS1106_7_P1"""
"1"," ""CS1133_1_P6"""
"1"," ""CS1133_2_P6"""
"1","
"
"1","[10]"
"1"," ""CS1133_3_P6"""
"1"," ""CS1133_4_P6"""
"1"," ""CS1133_5_P6"""
"1"," ""CS1133_6_P6"""
"1"," ""CS1133_7_P6"""
"1"," ""DMSOHigh_P1"""
"1"," ""DMSOLow_P1"" "
"1"," ""Medium_P6""  "
"1","
"
"0","# Initialize the relevance filter output data frame"
"0","relevanceFilter <- data.frame(probe_name = rownames(cpmData))"
"0",""
"0","# For each unique mean ID"
"0","for(i in loop){"
"0","  # Subset metadata to include only samples with that mean ID"
"0","  set <- metaData %>% "
"0","    filter(mean_ID == i)"
"0","  "
"0","  # Subset the CPM data to include only those samples"
"0","  cpm.set <- cpmData[ , set$sample_ID]"
"0","  "
"0","  # Count the percentage of values for each probe that are above 1"
"0","  df.set <- data.frame(round(100 * rowSums(cpm.set > 1) / ncol(cpm.set), 2)) %>% "
"0","    rownames_to_column(var = ""probe_name"")"
"0","  "
"0","  # Set the column name to the current mean ID"
"0","  colnames(df.set) <- c(""probe_name"", i)"
"0","  "
"0","  # Merge with the relevance filter output thus far"
"0","  relevanceFilter <- left_join(relevanceFilter, df.set, by=""probe_name"")"
"0","}"
"0",""
"0","# Make the probe name column into the row names"
"0","relevanceFilter <- relevanceFilter %>% "
"0","  column_to_rownames(var=""probe_name"")"
"0",""
"0","# Show the first 6 rows of the output"
"0","head(relevanceFilter)"
