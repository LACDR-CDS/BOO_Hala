"0","if (exists(""manifest"") && (""flag_realignment"" %in% colnames(manifest)) &&"
"0","    exists(""countData"")) {"
"0",""
"0"," identifiers_to_keep_from_manifest <- manifest %>%"
"0","    filter(flag_realignment != ""Remove"") %>% # Keeps ""Keep Unchanged"" and ""Rename"""
"0","    pull(probe_name_old) "
"0"," filtered_countData <- countData[rownames(countData) %in% identifiers_to_keep_from_manifest, , drop = FALSE]"
"0",""
"0","if (nrow(filtered_countData) == 0 && length(identifiers_to_keep_from_manifest) > 0) {"
"0","    cat(""CRITICAL WARNING: 'filtered_countData' is empty (0 rows).\n"")"
"0","    cat(""This strongly indicates that the identifiers in 'manifest$probe_name_old' (for probes to keep)\n"")"
"0","    cat(""do NOT match the 'rownames(countData)'. Please resolve the identifier format mismatch.\n"")"
"0","  } else if (nrow(filtered_countData) > 0) {"
"0","    cat(""Successfully created 'filtered_countData'.\n"")"
"0","    cat(""First few rows and columns of 'filtered_countData':\n"")"
"0","    print(head(filtered_countData[, 1:min(5, ncol(filtered_countData))]))"
"0","  } else {"
"0","    cat(""'filtered_countData' is empty. This might also be because no probes were flagged to keep in the manifest.\n"")"
"0","  }"
"0","  "
"0","} else {"
"0","  cat(""ERROR: 'manifest' (with 'flag_realignment' column) and/or 'countData' objects not found,\n"")"
"0","  cat(""or 'manifest' is not a valid data frame/tibble, or 'flag_realignment' column is missing.\n"")"
"0","  cat(""Please ensure these were loaded and processed correctly in previous steps.\n"")"
"0","}"
"1","Successfully created 'filtered_countData'.
"
"1","First few rows and columns of 'filtered_countData':
"
